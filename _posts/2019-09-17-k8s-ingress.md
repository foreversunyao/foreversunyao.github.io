---
layout: post
title: "K8s ingress"
date: 2019-09-17 23:25:06
description: Kubernetes ingress,ingress controller and metallb
tags:
 - cloud
---

[refer](https://www.a10networks.com/blog/what-is-kubernetes-ingress/)

![img]({{ '/assets/images/cloud/ingress.png' | relative_url }}){: .center-image }*(°0°)*

**Ingress**
Ingress is an API object that manages external access to services in the
cluster, mostly over HTTP/HTTPS , like a collection of routing rules that gaven how external users access services running in a Kubernetes cluster.

**Ingress Resources**
The ingress resource contains metadata configuration parameters for the third-party systems. These parameters include security policies, routing rules and traffic steering parameters. The ingress controller works with the ingress resource to automatically provision application delivery systems.
- example:
```
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: hello-world
spec:
  rules:
  - http:
      paths:
      - path: /api/hello-world
        backend:
          serviceName: hello-world
          servicePort: 80
```

**Ingress Controllers**
The ingress controller is a Kubernetes service responsible for managing ingress network traffic. This is primarily accomplished by providing an interface between the Kubernetes environment and third-party ingress systems like network and security systems. These systems have proprietary management interfaces, so the ingress controller is also provided by the third-party vendor.
Monitor Ingress resources via the Kubernetes API and update the configuration of a load balancer in case of any changes.Acts as reverse proxy for the Ingress rules found at api-server’s /ingresses endpoint
There are multiple ways to access an Ingress Controller from outside of a cluster:
HostPorts - You can configure each pod to accept traffic on a host port
NodePorts - You can create a node port service to forward traffic to the IC from the service port on every node LoadBalancer - Cloud deployments can use LB services for forward traffic to the IC.
```
client  --> Ingress Controller(deployment)(by service with hostport/by loadbalancer service) --> ingress --> service --> deployment(pod)
```
**multi controllers**
ingress-class + annotations


**Methods to route traffic**
[refer](https://www.weave.works/blog/kubernetes-faq-how-can-i-route-traffic-for-kubernetes-on-bare-metal)
- proxy + clusterIP
- NodePort
- Ingress
- Load Balncer

**metallb**
[refer](https://www.objectif-libre.com/en/blog/2019/06/11/metallb/)
MetalLB is a Loadbalancer implementation for bare metal Kubernetes clusters, based on standard routing protocols.
For this a network address pool must be reserved for MetalLB. Once MetalLB has assigned an external IP address to a service, it needs to redirect the traffic from the external IP to the cluster. To do so, MetalLB uses standard protocols such as ARP, NDP, or BGP.

[ingress](http://tech.prosiebensat1.com/blog/post/kubernetes-ingress-networking-part-i)
[bgp](http://tech.prosiebensat1.com/blog/post/kubernetes-ingress-networking-part-ii)
[dns](http://tech.prosiebensat1.com/blog/post/kubernetes-ingress-networking-part-iii)
