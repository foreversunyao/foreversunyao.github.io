---
layout: post
title: "K8s dex(WIP)"
date: 2019-11-14 20:10:06
description: authentication, authorization, OpenID , dex, ldap
tags:
 - cloud
---

[refer doc](https://flywzj.com/blog/dex/)
[refer git](https://github.com/krishnapmv/k8s-ldap)

**OpenID Connect Tokens**
OpenID Connect is a flavor of OAuth2 supported by some OAuth2 providers, notably Azure Active Directory, Salesforce, and Google. The protocol’s main extension of OAuth2 is an additional field returned with the access token called an ID Token. This token is a JSON Web Token (JWT) with well known fields, such as a user’s email, signed by the server.
To identify the user, the authenticator uses the id_token (not the access_token) from the OAuth2 token response as a bearer token. See above for how the token is included in a request.

[WorkFlow](https://kubernetes.io/docs/reference/access-authn-authz/authentication/#openid-connect-tokens)
![img]({{ '/assets/images/cloud/dex_google_auth.png' | relative_url }}){: .center-image }*(°0°)*

- Login to your identity provider
- Your identity provider will provide you with an access_token, id_token and a refresh_token
- When using kubectl, use your id_token with the --token flag or add it directly to your kubeconfig
- kubectl sends your id_token in a header called Authorization to the API server
- The API server will make sure the JWT signature is valid by checking against the certificate named in the configuration
- Check to make sure the id_token hasn’t expired
- Make sure the user is authorized
- Once authorized the API server returns a response to kubectl
- kubectl provides feedback to the user

**Configuring the API Server**
[link](https://kubernetes.io/docs/reference/access-authn-authz/authentication/#configuring-the-api-server)
